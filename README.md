# 설비 관리 프로그램 (PySide6 + SQLite)

이 프로젝트는 **회사 공유 폴더**에서 여러 사람이 함께 쓰는 것을 목표로 한 **데스크톱 앱**입니다.
엑셀 파일(설비관리대장, 이력카드, 소모품 입출고, 개선/수리)을 **한 프로그램**으로 연동합니다.

## 빠른 시작 (처음 1번만)
1) 파이썬 3.10~3.12 권장 (3.13도 대부분 문제 없음)
2) 터미널(혹은 CMD)에서 다음 실행
```bash
cd equipment_manager_app
python -m venv .venv
# Windows
.venv\Scripts\activate
# macOS/Linux
source .venv/bin/activate

pip install -r requirements.txt
```

## 실행
```bash
python app.py
```

## 데이터 저장 위치
- `data/app.db` : SQLite DB (WAL 모드). **공유폴더에 놓고 함께 사용 가능** (동시 대량쓰기 지양).
- `photos/` : 설비별 폴더 자동 생성하여 사진 보관.
- `exports/` : 내보내기 엑셀 저장.
- 최초 실행 시 DB와 기본 테이블이 자동 생성됩니다.

## 주요 기능
1. 설비관리대장 탭에서 설비 번호/명 더블클릭 → 해당 설비 **이력카드 탭으로 전환**.
2. 개선/수리 등록 시 해당 설비의 **이력카드(개선·수리 영역) 자동 반영**.
3. 소모품 입출고/임의조정 및 **최저 재고(안전수량) 미만 알림** 팝업.
4. 개선/수리에서 소모품 사용 시 **자동 차감**(여러 품목/수량 입력 가능).
5. 개선/수리 이력 **필터+내보내기(엑셀)**.
6. 설비관리대장에서 **신규 추가** 또는 **엑셀 가져오기**.
7. 설비별 **사진 폴더 자동 생성** + 이력카드 탭에서 사진 등록 경로 저장.
8. **빠른 시작/빠른 전환**을 위해 DB 튜닝(WAL, pragma) 및 지연 로딩 적용.
9. **탭별 화면**으로 분리(설비관리대장/이력카드/개선수리/소모품/내보내기).
10. **코드 분산**(db.py, models.py, services/*, ui/*)으로 유지보수 편리.

## 엑셀 매핑 (기본 예시)
- `설비관리대장.xlsx`: 관리번호, 설비명, 모델, 제조사, 설치일, 비고
- `이력카드 샘플.xlsx`: 관리번호, 설비명, 주요사양, 사진경로 등(필요 컬럼만 인식)
- `소모품 입출고 샘플.xlsx`: 품목, 규격, 현재고, 안전수량, 비고
- `2024년도 설비개선 및 수리 현황.xlsx`: 관리번호, 설비명, 일자, 구분, 내용, 사용소모품(품목·수량)

> 컬럼명이 달라도 가져오기 마법사에서 **열 매핑**으로 정렬 없이 읽을 수 있도록 구현했습니다.

## 공유 폴더에서 쓰기
- `equipment_manager_app` 폴더 전체를 **회사 공유 폴더**로 복사.
- 동시 쓰기 충돌을 줄이기 위해 기록 저장 시 **짧은 재시도**/락 확인 로직 포함.

## 참고
- SQLite는 네트워크 드라이브에서 **읽기/쓰기**가 가능하나, 아주 잦은 동시 쓰기에는 서버 DB가 더 안전합니다.
- 본 프로젝트는 **즉시 반응**을 최우선으로 가볍게 설계했습니다.
